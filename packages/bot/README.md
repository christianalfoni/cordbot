# ClaudeBot - Discord Bot CLI with Claude Code SDK

A command-line tool that creates a Discord bot powered by the Claude Code SDK. It syncs Discord channels with local folders, manages Claude sessions with full conversation history, and supports scheduled autonomous tasks.

## Features

- **ğŸŒ Global CLI Tool**: Install once with `npm install -g claudebot`, use anywhere
- **ğŸ“ Directory-Based**: Each project directory has its own configuration and synced channels
- **ğŸ¤– Autonomous Agent**: Full Claude Code SDK capabilities with dangerous mode enabled
- **ğŸ’¬ Thread-Based Sessions**: Each Discord thread maintains persistent Claude sessions
- **ğŸ“‹ Plan Attachments**: Automatically sends implementation plans as downloadable `.md` files
- **â° Scheduled Tasks**: Configure autonomous tasks with `.claude-cron` files
- **ğŸ”„ Hot Reload**: Watches for cron file changes and reloads automatically
- **ğŸ¨ Interactive Setup**: First-time setup wizard with validation

## Installation

```bash
# Install globally
npm install -g claudebot

# Or install locally in your project
npm install claudebot
```

## Quick Start

```bash
# Navigate to your project
cd ~/my-project

# Run (prompts for config on first run)
claudebot

# Bot syncs Discord channels to folders in current directory
# Each channel becomes a folder with CLAUDE.md and .claude-cron
# State managed in .claude/ folder
```

## Prerequisites

Before running ClaudeBot, you need:

1. **Discord Bot Token** - Create a bot at https://discord.com/developers/applications
2. **Discord Guild (Server) ID** - Right-click your server â†’ Copy Server ID
3. **Anthropic API Key** - Get one at https://console.anthropic.com

See [Discord Bot Setup Guide](CLAUDEBOT.md#discord-bot-setup-prerequisites) for detailed instructions.

## Configuration

On first run, ClaudeBot will prompt you for configuration:

```
ğŸ¤– ClaudeBot - Discord Bot powered by Claude Code SDK

No .env file found in current directory.
Current directory: /Users/you/my-project

? Would you like to configure ClaudeBot now? (Y/n)

ğŸ“ Please provide the following configuration:

? Discord Bot Token: [hidden]
? Discord Guild (Server) ID: 123456789012345678
? Anthropic API Key: [hidden]
? Claude Model (optional): claude-sonnet-4-5-20250929
? Log Level: info
? Archive inactive sessions after (days): 30
```

This creates a `.env` file in your current directory:

```bash
# ClaudeBot Configuration
# Generated by claudebot CLI

# Discord Configuration
DISCORD_BOT_TOKEN=your_bot_token_here
DISCORD_GUILD_ID=your_guild_id_here

# Anthropic Configuration
ANTHROPIC_API_KEY=your_api_key_here

# Optional Settings
CLAUDE_MODEL=claude-sonnet-4-5-20250929
LOG_LEVEL=info
ARCHIVE_AFTER_DAYS=30
```

## Directory Structure

After running ClaudeBot, your project will look like this:

```
my-project/
â”œâ”€â”€ .env                      # Configuration (git-ignored)
â”œâ”€â”€ .claude/                  # Bot state (git-ignored)
â”‚   â”œâ”€â”€ config.json          # Discord bot config
â”‚   â”œâ”€â”€ mappings.db          # SQLite: Discord ID â†” Session ID
â”‚   â””â”€â”€ sessions/            # Agent session persistence
â”œâ”€â”€ CLAUDE.md                # Root bot instructions
â””â”€â”€ (Discord channel folders)/
    â”œâ”€â”€ general/
    â”‚   â”œâ”€â”€ CLAUDE.md        # Channel-specific context
    â”‚   â”œâ”€â”€ .claude-cron     # Scheduled jobs
    â”‚   â””â”€â”€ ... (your files)
    â””â”€â”€ backend/
        â”œâ”€â”€ CLAUDE.md
        â”œâ”€â”€ .claude-cron
        â””â”€â”€ ... (your files)
```

## Usage

### Interactive Conversations

Just message the bot in Discord:

```
#backend channel

ğŸ‘¤ You: Hey Claude, what's the latest commit?

[Bot creates thread: "You: Hey Claude, what's the latest..."]

ğŸ¤– Claude: The latest commit is "fix auth flow" (abc123)
          from 2 hours ago.
```

### Thread-Based Sessions

Each Discord thread maintains a persistent conversation:

```
[In thread]
ğŸ‘¤ You: Can you explain that change?

ğŸ¤– Claude: That commit fixed the JWT validation logic...

ğŸ‘¤ You: Can you run the tests?

âš™ï¸ bash: npm test

ğŸ¤– Claude: All tests passed! âœ“ 23 tests
```

### Scheduled Tasks

Configure autonomous tasks in `.claude-cron` files:

```yaml
jobs:
  - name: "Daily summary"
    schedule: "0 9 * * *"
    task: "Summarize recent changes"
    postTo: "thread"

  - name: "Weekly report"
    schedule: "0 9 * * 1"
    task: "Generate weekly report"
    postTo: "channel"
```

Cron schedules use standard format: `minute hour day month weekday`

## Development

```bash
# Clone the repository
git clone https://github.com/yourusername/claudebot.git
cd claudebot

# Install dependencies
npm install

# Run in development mode
npm run dev

# Build
npm run build

# Run tests
npm test

# Run tests with UI
npm run test:ui
```

## Security

**Important**: ClaudeBot runs in "dangerous mode" with full system access:

- Full filesystem access
- Bash command execution
- Network operations
- Package management

Only use in trusted environments with controlled Discord access. Never share your `.env` file or commit it to git.

## How It Works

1. **Directory-Based**: Each project directory has its own configuration
2. **Channel Sync**: Discord channels sync to local folders automatically
3. **Thread Sessions**: Each Discord thread maps to a persistent Claude session
4. **CLAUDE.md Files**: Provide context to Claude about your project
5. **Autonomous Mode**: Claude has full access to read/write files and run commands
6. **Session Persistence**: Conversations resume automatically in threads

## Documentation

For detailed documentation, see [CLAUDEBOT.md](CLAUDEBOT.md) which includes:

- Complete Discord bot setup guide
- Architecture explanation
- Authentication details
- Session management
- Scheduled tasks
- Implementation details

## License

MIT

## Contributing

Contributions welcome! Please open an issue or PR.
